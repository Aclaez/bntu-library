{"ast":null,"code":"import _objectSpread from\"C:/Users/trs_user/Documents/my/bntu-library/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React from\"react\";import*as FileSaver from\"file-saver\";import*as XLSX from\"xlsx\";import{jsx as _jsx}from\"react/jsx-runtime\";var transformData=function transformData(columns,data){var oldKeys=Object.keys(data===null||data===void 0?void 0:data[0]);var newKeys=[];oldKeys.forEach(function(key){var column=columns.find(function(column){return column.accessor===key;});newKeys.push(column.Header);});return data.map(function(item){var newItem={};oldKeys.forEach(function(key,index){newItem[newKeys[index]]=item[key];delete item[key];});return _objectSpread(_objectSpread({},newItem),item);});};function ExcelExportBtn(_ref){var csvData=_ref.csvData,columns=_ref.columns,fileName=_ref.fileName,closeMenu=_ref.closeMenu;var fileType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";var fileExtension=\".xlsx\";var correctData=transformData(columns,csvData);var exportToCSV=function exportToCSV(correctData,fileName){var ws=XLSX.utils.json_to_sheet(correctData);var wb={Sheets:{data:ws},SheetNames:[\"data\"]};var excelBuffer=XLSX.write(wb,{bookType:\"xlsx\",type:\"array\"});var data=new Blob([excelBuffer],{type:fileType});FileSaver.saveAs(data,fileName+fileExtension);};return/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){closeMenu();exportToCSV(correctData,fileName);},children:\"\\u042D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442 \\u0432 Excel\"});}export default ExcelExportBtn;","map":{"version":3,"names":["React","FileSaver","XLSX","jsx","_jsx","transformData","columns","data","oldKeys","Object","keys","newKeys","forEach","key","column","find","accessor","push","Header","map","item","newItem","index","_objectSpread","ExcelExportBtn","_ref","csvData","fileName","closeMenu","fileType","fileExtension","correctData","exportToCSV","ws","utils","json_to_sheet","wb","Sheets","SheetNames","excelBuffer","write","bookType","type","Blob","saveAs","onClick","children"],"sources":["C:/Users/trs_user/Documents/my/bntu-library/src/components/ExcelExportBtn/index.js"],"sourcesContent":["import React from \"react\";\r\nimport * as FileSaver from \"file-saver\";\r\nimport * as XLSX from \"xlsx\";\r\n\r\nconst transformData = (columns, data) => {\r\n  const oldKeys = Object.keys(data?.[0]);\r\n\r\n  let newKeys = [];\r\n\r\n  oldKeys.forEach((key) => {\r\n    const column = columns.find((column) => column.accessor === key);\r\n    newKeys.push(column.Header);\r\n  });\r\n\r\n  return data.map((item) => {\r\n    const newItem = {};\r\n    oldKeys.forEach((key, index) => {\r\n      newItem[newKeys[index]] = item[key];\r\n      delete item[key];\r\n    });\r\n    return { ...newItem, ...item };\r\n  });\r\n};\r\n\r\nfunction ExcelExportBtn({ csvData, columns, fileName, closeMenu }) {\r\n  const fileType =\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\r\n  const fileExtension = \".xlsx\";\r\n\r\n  const correctData = transformData(columns, csvData);\r\n\r\n  const exportToCSV = (correctData, fileName) => {\r\n    const ws = XLSX.utils.json_to_sheet(correctData);\r\n    const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\r\n    const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\r\n    const data = new Blob([excelBuffer], { type: fileType });\r\n    FileSaver.saveAs(data, fileName + fileExtension);\r\n  };\r\n\r\n  return (\r\n    <button\r\n      onClick={() => {\r\n        closeMenu();\r\n        exportToCSV(correctData, fileName);\r\n      }}\r\n    >\r\n      Экспорт в Excel\r\n    </button>\r\n  );\r\n}\r\n\r\nexport default ExcelExportBtn;\r\n"],"mappings":"gIAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,MAAO,GAAK,CAAAC,SAAS,KAAM,YAAY,CACvC,MAAO,GAAK,CAAAC,IAAI,KAAM,MAAM,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE7B,GAAM,CAAAC,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAIC,OAAO,CAAEC,IAAI,CAAK,CACvC,GAAM,CAAAC,OAAO,CAAGC,MAAM,CAACC,IAAI,CAACH,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAG,CAAC,CAAC,CAAC,CAEtC,GAAI,CAAAI,OAAO,CAAG,EAAE,CAEhBH,OAAO,CAACI,OAAO,CAAC,SAACC,GAAG,CAAK,CACvB,GAAM,CAAAC,MAAM,CAAGR,OAAO,CAACS,IAAI,CAAC,SAACD,MAAM,QAAK,CAAAA,MAAM,CAACE,QAAQ,GAAKH,GAAG,GAAC,CAChEF,OAAO,CAACM,IAAI,CAACH,MAAM,CAACI,MAAM,CAAC,CAC7B,CAAC,CAAC,CAEF,MAAO,CAAAX,IAAI,CAACY,GAAG,CAAC,SAACC,IAAI,CAAK,CACxB,GAAM,CAAAC,OAAO,CAAG,CAAC,CAAC,CAClBb,OAAO,CAACI,OAAO,CAAC,SAACC,GAAG,CAAES,KAAK,CAAK,CAC9BD,OAAO,CAACV,OAAO,CAACW,KAAK,CAAC,CAAC,CAAGF,IAAI,CAACP,GAAG,CAAC,CACnC,MAAO,CAAAO,IAAI,CAACP,GAAG,CAAC,CAClB,CAAC,CAAC,CACF,OAAAU,aAAA,CAAAA,aAAA,IAAYF,OAAO,EAAKD,IAAI,EAC9B,CAAC,CAAC,CACJ,CAAC,CAED,QAAS,CAAAI,cAAcA,CAAAC,IAAA,CAA4C,IAAzC,CAAAC,OAAO,CAAAD,IAAA,CAAPC,OAAO,CAAEpB,OAAO,CAAAmB,IAAA,CAAPnB,OAAO,CAAEqB,QAAQ,CAAAF,IAAA,CAARE,QAAQ,CAAEC,SAAS,CAAAH,IAAA,CAATG,SAAS,CAC7D,GAAM,CAAAC,QAAQ,CACZ,iFAAiF,CACnF,GAAM,CAAAC,aAAa,CAAG,OAAO,CAE7B,GAAM,CAAAC,WAAW,CAAG1B,aAAa,CAACC,OAAO,CAAEoB,OAAO,CAAC,CAEnD,GAAM,CAAAM,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAID,WAAW,CAAEJ,QAAQ,CAAK,CAC7C,GAAM,CAAAM,EAAE,CAAG/B,IAAI,CAACgC,KAAK,CAACC,aAAa,CAACJ,WAAW,CAAC,CAChD,GAAM,CAAAK,EAAE,CAAG,CAAEC,MAAM,CAAE,CAAE9B,IAAI,CAAE0B,EAAG,CAAC,CAAEK,UAAU,CAAE,CAAC,MAAM,CAAE,CAAC,CACzD,GAAM,CAAAC,WAAW,CAAGrC,IAAI,CAACsC,KAAK,CAACJ,EAAE,CAAE,CAAEK,QAAQ,CAAE,MAAM,CAAEC,IAAI,CAAE,OAAQ,CAAC,CAAC,CACvE,GAAM,CAAAnC,IAAI,CAAG,GAAI,CAAAoC,IAAI,CAAC,CAACJ,WAAW,CAAC,CAAE,CAAEG,IAAI,CAAEb,QAAS,CAAC,CAAC,CACxD5B,SAAS,CAAC2C,MAAM,CAACrC,IAAI,CAAEoB,QAAQ,CAAGG,aAAa,CAAC,CAClD,CAAC,CAED,mBACE1B,IAAA,WACEyC,OAAO,CAAE,SAAAA,QAAA,CAAM,CACbjB,SAAS,EAAE,CACXI,WAAW,CAACD,WAAW,CAAEJ,QAAQ,CAAC,CACpC,CAAE,CAAAmB,QAAA,CACH,yDAED,EAAS,CAEb,CAEA,cAAe,CAAAtB,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}