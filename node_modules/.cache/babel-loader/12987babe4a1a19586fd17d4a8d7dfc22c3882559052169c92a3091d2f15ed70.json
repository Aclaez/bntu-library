{"ast":null,"code":"import _slicedToArray from\"C:/Users/trs_user/Documents/my/bntu-library/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import styles from\"./Publications.module.scss\";import DataPageLayout from\"../../components/DataPageLayout/DataPageLayout\";import SearchBar from\"../../components/SearchBar/SearchBar\";import Table from\"../../components/Table/Table\";import{filtersByDefault,filtersList,getTransformedData,searchFieldsList,tableColumns}from\"../../variables/publications\";import{api}from\"../../api/api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Publications(){var _useState=useState(tableColumns),_useState2=_slicedToArray(_useState,2),columns=_useState2[0],setColumns=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),dataCount=_useState6[0],setDataCount=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isError=_useState8[0],setError=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),query=_useState10[0],setQuery=_useState10[1];var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),currentPage=_useState12[0],setCurrentPage=_useState12[1];useEffect(function(){setError(false);if(query){api.getWorks(query,currentPage).then(function(data){setData(getTransformedData(data.results));setDataCount(data.meta.count);}).catch(function(err){setError(true);setData([]);setDataCount(0);console.error(err);});}},[query,currentPage]);useEffect(function(){console.log(data);},[data]);return/*#__PURE__*/_jsxs(DataPageLayout,{children:[/*#__PURE__*/_jsx(SearchBar,{title:\"\\u041F\\u043E\\u0438\\u0441\\u043A \\u043F\\u0443\\u0431\\u043B\\u0438\\u043A\\u0430\\u0446\\u0438\\u0438\",fieldsNames:searchFieldsList,columns:columns,setColumns:setColumns,filtersList:filtersList,filtersByDefault:filtersByDefault,setQuery:setQuery,currentPage:currentPage,setCurrentPage:setCurrentPage,setError:setError}),!isError&&data.length>0&&/*#__PURE__*/_jsx(Table,{columns:columns,data:data,dataCount:dataCount,currentPage:currentPage,setCurrentPage:setCurrentPage}),data.length===0&&/*#__PURE__*/_jsx(\"div\",{className:styles.informer,children:/*#__PURE__*/_jsx(\"p\",{className:styles.text,children:\"\\u041F\\u043E \\u0432\\u0430\\u0448\\u0435\\u043C\\u0443 \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\\u0443 \\u043D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"})}),isError&&/*#__PURE__*/_jsx(\"div\",{className:styles.informer,children:/*#__PURE__*/_jsx(\"p\",{className:styles.text,children:\"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430, \\u043F\\u0440\\u043E\\u0432\\u0435\\u0440\\u044C\\u0442\\u0435 \\u043A\\u043E\\u0440\\u0440\\u0435\\u043A\\u0442\\u043D\\u043E\\u0441\\u0442\\u044C \\u0432\\u0432\\u0435\\u0434\\u0451\\u043D\\u043D\\u044B\\u0445 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0438 \\u043F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u043F\\u043E\\u0432\\u0442\\u043E\\u0440\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\"})})]});}export default Publications;","map":{"version":3,"names":["React","useEffect","useState","styles","DataPageLayout","SearchBar","Table","filtersByDefault","filtersList","getTransformedData","searchFieldsList","tableColumns","api","jsx","_jsx","jsxs","_jsxs","Publications","_useState","_useState2","_slicedToArray","columns","setColumns","_useState3","_useState4","data","setData","_useState5","_useState6","dataCount","setDataCount","_useState7","_useState8","isError","setError","_useState9","_useState10","query","setQuery","_useState11","_useState12","currentPage","setCurrentPage","getWorks","then","results","meta","count","catch","err","console","error","log","children","title","fieldsNames","length","className","informer","text"],"sources":["C:/Users/trs_user/Documents/my/bntu-library/src/pages/Publications/Publications.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport styles from \"./Publications.module.scss\";\r\nimport DataPageLayout from \"../../components/DataPageLayout/DataPageLayout\";\r\nimport SearchBar from \"../../components/SearchBar/SearchBar\";\r\nimport Table from \"../../components/Table/Table\";\r\nimport {\r\n  filtersByDefault,\r\n  filtersList,\r\n  getTransformedData,\r\n  searchFieldsList,\r\n  tableColumns,\r\n} from \"../../variables/publications\";\r\nimport { api } from \"../../api/api\";\r\n\r\nfunction Publications() {\r\n  const [columns, setColumns] = useState(tableColumns);\r\n  const [data, setData] = useState({});\r\n  const [dataCount, setDataCount] = useState(0);\r\n  const [isError, setError] = useState(false);\r\n\r\n  const [query, setQuery] = useState(null);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n\r\n  useEffect(() => {\r\n    setError(false);\r\n\r\n    if (query) {\r\n      api\r\n        .getWorks(query, currentPage)\r\n        .then((data) => {\r\n          setData(getTransformedData(data.results));\r\n          setDataCount(data.meta.count);\r\n        })\r\n        .catch((err) => {\r\n          setError(true);\r\n          setData([]);\r\n          setDataCount(0);\r\n          console.error(err);\r\n        });\r\n    }\r\n  }, [query, currentPage]);\r\n\r\n  useEffect(() => {\r\n    console.log(data);\r\n  }, [data]);\r\n\r\n  return (\r\n    <DataPageLayout>\r\n      <SearchBar\r\n        title=\"Поиск публикации\"\r\n        fieldsNames={searchFieldsList}\r\n        columns={columns}\r\n        setColumns={setColumns}\r\n        filtersList={filtersList}\r\n        filtersByDefault={filtersByDefault}\r\n        setQuery={setQuery}\r\n        currentPage={currentPage}\r\n        setCurrentPage={setCurrentPage}\r\n        setError={setError}\r\n      />\r\n      {!isError && data.length > 0 && (\r\n        <Table\r\n          columns={columns}\r\n          data={data}\r\n          dataCount={dataCount}\r\n          currentPage={currentPage}\r\n          setCurrentPage={setCurrentPage}\r\n        />\r\n      )}\r\n\r\n      {data.length === 0 && (\r\n        <div className={styles.informer}>\r\n          <p className={styles.text}>По вашему запросу ничего не найдено</p>\r\n        </div>\r\n      )}\r\n\r\n      {isError && (\r\n        <div className={styles.informer}>\r\n          <p className={styles.text}>\r\n            Произошла ошибка, проверьте корректность введённых данных и\r\n            попробуйте повторить запрос\r\n          </p>\r\n        </div>\r\n      )}\r\n    </DataPageLayout>\r\n  );\r\n}\r\n\r\nexport default Publications;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}