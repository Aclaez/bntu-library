{"ast":null,"code":"import { useEffect, useState } from 'react';\nimport { off, on } from \"../util/misc.js\";\n/**\n * Tracks a permission state.\n *\n * @param descriptor Permission request descriptor that passed to `navigator.permissions.query`\n */\nexport function usePermission(descriptor) {\n  const [state, setState] = useState('not-requested');\n  useEffect(() => {\n    const unmount = {\n      current: null\n    };\n    setState('requested');\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises,promise/catch-or-return\n    navigator.permissions.query(descriptor)\n    // eslint-disable-next-line promise/always-return\n    .then(status => {\n      const handleChange = () => {\n        setState(status.state);\n      };\n      setState(status.state);\n      on(status, 'change', handleChange, {\n        passive: true\n      });\n      unmount.current = () => {\n        off(status, 'change', handleChange);\n      };\n    });\n    return () => {\n      if (unmount.current) {\n        unmount.current();\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [descriptor.name]);\n  return state;\n}","map":{"version":3,"names":["useEffect","useState","off","on","usePermission","descriptor","state","setState","unmount","current","navigator","permissions","query","then","status","handleChange","passive","name"],"sources":["C:/Users/trs_user/Documents/my/bntu-library/node_modules/@react-hookz/web/esm/usePermission/index.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { off, on } from \"../util/misc.js\";\n/**\n * Tracks a permission state.\n *\n * @param descriptor Permission request descriptor that passed to `navigator.permissions.query`\n */\nexport function usePermission(descriptor) {\n    const [state, setState] = useState('not-requested');\n    useEffect(() => {\n        const unmount = { current: null };\n        setState('requested');\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises,promise/catch-or-return\n        navigator.permissions\n            .query(descriptor)\n            // eslint-disable-next-line promise/always-return\n            .then((status) => {\n            const handleChange = () => {\n                setState(status.state);\n            };\n            setState(status.state);\n            on(status, 'change', handleChange, { passive: true });\n            unmount.current = () => {\n                off(status, 'change', handleChange);\n            };\n        });\n        return () => {\n            if (unmount.current) {\n                unmount.current();\n            }\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [descriptor.name]);\n    return state;\n}\n"],"mappings":"AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,GAAG,EAAEC,EAAE,QAAQ,iBAAiB;AACzC;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,aAAaA,CAACC,UAAU,EAAE;EACtC,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGN,QAAQ,CAAC,eAAe,CAAC;EACnDD,SAAS,CAAC,MAAM;IACZ,MAAMQ,OAAO,GAAG;MAAEC,OAAO,EAAE;IAAK,CAAC;IACjCF,QAAQ,CAAC,WAAW,CAAC;IACrB;IACAG,SAAS,CAACC,WAAW,CAChBC,KAAK,CAACP,UAAU;IACjB;IAAA,CACCQ,IAAI,CAAEC,MAAM,IAAK;MAClB,MAAMC,YAAY,GAAGA,CAAA,KAAM;QACvBR,QAAQ,CAACO,MAAM,CAACR,KAAK,CAAC;MAC1B,CAAC;MACDC,QAAQ,CAACO,MAAM,CAACR,KAAK,CAAC;MACtBH,EAAE,CAACW,MAAM,EAAE,QAAQ,EAAEC,YAAY,EAAE;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;MACrDR,OAAO,CAACC,OAAO,GAAG,MAAM;QACpBP,GAAG,CAACY,MAAM,EAAE,QAAQ,EAAEC,YAAY,CAAC;MACvC,CAAC;IACL,CAAC,CAAC;IACF,OAAO,MAAM;MACT,IAAIP,OAAO,CAACC,OAAO,EAAE;QACjBD,OAAO,CAACC,OAAO,EAAE;MACrB;IACJ,CAAC;IACD;EACJ,CAAC,EAAE,CAACJ,UAAU,CAACY,IAAI,CAAC,CAAC;EACrB,OAAOX,KAAK;AAChB"},"metadata":{},"sourceType":"module","externalDependencies":[]}